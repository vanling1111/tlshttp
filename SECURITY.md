# 安全政策 (Security Policy)

## 🔒 报告安全漏洞

我们非常重视 tlshttp 项目的安全性。如果您发现了安全漏洞，请**不要**公开提交 Issue。

### 报告方式

请通过以下方式私密报告安全问题：

1. **GitHub Security Advisories** (推荐)
   - 访问 https://github.com/vanling1111/tlshttp/security/advisories/new
   - 填写安全漏洞详情

2. **电子邮件**
   - 发送到项目维护者的私人邮箱
   - 主题：[SECURITY] tlshttp 安全漏洞报告

### 报告内容

请在报告中包含以下信息：

- **漏洞描述**：清晰描述安全问题
- **影响范围**：哪些版本受影响
- **复现步骤**：详细的复现步骤
- **概念验证**：PoC 代码（如果有）
- **建议修复**：您的修复建议（可选）
- **严重程度**：您认为的严重程度评级

### 响应时间

我们承诺：

- **24 小时内**：确认收到报告
- **7 天内**：评估漏洞并给出初步响应
- **30 天内**：发布修复补丁（根据严重程度）

## 🛡️ 支持的版本

我们为以下版本提供安全更新：

| 版本 | 支持状态 |
| --- | --- |
| latest (main) | ✅ 完全支持 |
| 0.1.x | ✅ 安全更新 |
| < 0.1.0 | ❌ 不支持 |

## ⚠️ 已知安全考虑

### TLS 指纹伪装

本项目的核心功能是 TLS 指纹伪装，用于：
- ✅ **合法用途**：爬虫、自动化测试、监控
- ❌ **不当用途**：绕过安全控制、恶意攻击

**免责声明**：本项目仅供学习和合法用途。使用者需自行承担使用本项目的法律责任。

### 依赖项安全

主要依赖：
- `github.com/refraction-networking/utls` - TLS 库
- `github.com/fxamacker/cbor/v2` - CBOR 序列化

我们会定期审查和更新依赖项的安全漏洞。

### 最佳实践

使用本项目时，请遵循以下安全最佳实践：

1. **验证 TLS 证书**
   ```go
   transport := &http.Transport{
       TLSClientConfig: &tls.Config{
           InsecureSkipVerify: false, // 不要跳过验证！
       },
   }
   ```

2. **使用最新版本**
   ```bash
   go get -u github.com/vanling1111/tlshttp
   ```

3. **审查代理设置**
   ```go
   // 确保代理 URL 来自可信源
   transport.Proxy = http.ProxyURL(proxyURL)
   ```

4. **保护敏感信息**
   - 不要在代码中硬编码密码、API 密钥
   - 使用环境变量或安全的密钥管理系统

5. **限制并发**
   ```go
   transport.MaxConnsPerHost = 10  // 防止资源耗尽
   transport.MaxIdleConns = 100
   ```

## 🔍 安全审计

### 已修复的安全相关问题

我们修复了以下关键安全问题：

1. **PSK 扩展 panic 问题**
   - 可能导致服务崩溃
   - ✅ 已修复：添加 PSK 扩展验证和初始化

2. **并发 map 访问问题**
   - 可能导致 panic 和数据竞争
   - ✅ 已修复：添加 map 初始化检查和并发保护

3. **内存泄漏问题**
   - 长时间运行可能耗尽内存
   - ✅ 已修复：改进连接池和资源管理

4. **Transport.Clone() 深拷贝缺陷**
   - 可能导致并发问题和配置丢失
   - ✅ 已修复：实现完整深度克隆

### 代码审计工具

我们使用以下工具进行安全审计：

```bash
# 静态分析
go vet ./...
golangci-lint run

# 依赖检查
go list -m all | nancy sleuth

# 漏洞扫描
govulncheck ./...
```

## 📋 安全检查清单

发布前的安全检查：

- [ ] 所有测试通过
- [ ] 静态分析无严重问题
- [ ] 依赖项无已知漏洞
- [ ] 代码审查完成
- [ ] 文档更新
- [ ] CHANGELOG 更新

## 🙏 致谢

我们感谢所有负责任地报告安全问题的研究人员和贡献者。

---

**最后更新**：2024-10-05

如有安全相关问题，请联系项目维护者。

